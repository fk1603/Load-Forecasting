
# First extract Weekday, Month, and Hour
df_merged["Weekday"] = df_merged["Timestamp"].dt.weekday  # 0 = Monday
df_merged["Month"] = df_merged["Timestamp"].dt.month
df_merged["Hour"] = df_merged["Timestamp"].dt.hour

# 1. Weekday vs. Month Heatmap of mean Actual_Load
weekday_month_data = df_merged.pivot_table(index='Weekday', columns='Month', values='Actual_Load', aggfunc='mean')
plt.figure(figsize=(10, 6))
sns.heatmap(weekday_month_data, annot=True, cmap="coolwarm", fmt=".2f",
            linewidths=0, cbar_kws={'shrink': 0.75}, square=True)
plt.title("Mean Load by Weekday and Month")
plt.ylabel("Weekday (0=Mon)")
plt.xlabel("Month")
plt.grid(False)
#plt.show()

# 2. Weekday vs. Hour Heatmap of mean Actual_Load
weekday_hour_data = df_merged.pivot_table(index='Weekday', columns='Hour', values='Actual_Load', aggfunc='mean')
plt.figure(figsize=(12, 6))
sns.heatmap(weekday_hour_data, annot=False, cmap="coolwarm", fmt=".2f",
            linewidths=0, cbar_kws={'shrink': 0.75}, square=True)
plt.title("Mean Load by Weekday and Hour")
plt.ylabel("Weekday (0=Mon)")
plt.xlabel("Hour")
plt.grid(False)
#plt.show()